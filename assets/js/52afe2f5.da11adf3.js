"use strict";(self.webpackChunktracetest_docs=self.webpackChunktracetest_docs||[]).push([[4262],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,p=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=l(n),d=a,h=c["".concat(p,".").concat(d)]||c[d]||m[d]||s;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=d;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[c]="string"==typeof e?e:a,o[1]=i;for(var l=2;l<s;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},11488:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var r=n(87462),a=(n(67294),n(3905));const s={},o="Running Tests From the Command Line Interface (CLI)",i={unversionedId:"cli/running-tests",id:"cli/running-tests",title:"Running Tests From the Command Line Interface (CLI)",description:"Once you have created a test, whether from the Tracetest UI or via a text editor, you will need the capabity to run it via the Command Line Interface (CLI) to integrate it into your CI/CD process or your local development workflow. The documentation for running a test via the CLI can be found here: tracetest test run. This page will provide some examples of using this command.",source:"@site/docs/cli/running-tests.md",sourceDirName:"cli",slug:"/cli/running-tests",permalink:"/cli/running-tests",draft:!1,editUrl:"https://github.com/kubeshop/tracetest/blob/main/docs/docs/cli/running-tests.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Defining Tests as Text Files",permalink:"/cli/creating-tests"},next:{title:"CLI Reference",permalink:"/cli/reference/tracetest"}},p={},l=[{value:"Running Your First Test",id:"running-your-first-test",level:2},{value:"Running a Test That Uses Environment Variables",id:"running-a-test-that-uses-environment-variables",level:2}],u={toc:l},c="wrapper";function m(e){let{components:t,...s}=e;return(0,a.kt)(c,(0,r.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"running-tests-from-the-command-line-interface-cli"},"Running Tests From the Command Line Interface (CLI)"),(0,a.kt)("p",null,"Once you have created a test, whether from the Tracetest UI or via a text editor, you will need the capabity to run it via the Command Line Interface (CLI) to integrate it into your CI/CD process or your local development workflow. The documentation for running a test via the CLI can be found here: ",(0,a.kt)("a",{parentName:"p",href:"/cli/reference/tracetest_test_run"},"tracetest test run"),". This page will provide some examples of using this command."),(0,a.kt)("h2",{id:"running-your-first-test"},"Running Your First Test"),(0,a.kt)("p",null,"To run a test, give the path to the test definition file with the '-d' option. This will launch a test, providing us with a link to the created test run."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tracetest test run -d path/to/test.yaml -w\n")),(0,a.kt)("p",null,"Output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"\u2714 Pokeshop - Import (http://localhost:11633/test/4oI08rA4g/run/3/test)\n")),(0,a.kt)("p",null,"Now, let's run the same test but tell the CLI to wait for the test to complete running before returning. This will provide results from the test."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tracetest test run -d path/to/test.yaml -w\n")),(0,a.kt)("p",null,"Output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"\u2718 Pokeshop - Import (http://localhost:11633/test/4oI08rA4g/run/12/test)\n    \u2714 Response should be ok\n        \u2714 #59ce1f4250482ba5\n            \u2714 attr:tracetest.response.status = 200 (200)\n    \u2714 JSON from external request should have name of 'meowth'\n        \u2714 #efa1be47f04a0d43\n            \u2714 attr:http.response.body| json_path '$.name' = \"diglett\" (diglett)\n    \u2718 Postgres DB queries are fast\n        \u2718 #f062f4d34031279e\n            \u2718 attr:tracetest.span.duration < 20ms (23ms) (http://localhost:11633/test/4oI08rA4g/run/12/test?selectedAssertion=2&selectedSpan=f062f4d34031279e)\n        \u2714 #0afed975903f2db5\n            \u2714 attr:tracetest.span.duration < 20ms (636us)\n        \u2714 #13ce59129b4e7e31\n            \u2714 attr:tracetest.span.duration < 20ms (2ms)\n")),(0,a.kt)("p",null,"Running the same command with the '-o json' option would change the output from the default of human readable 'pretty' to 'json'. This can be useful when you wish to extract particular data from the response. This would look like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tracetest test run -d path/to/test.yaml -w - o json\n")),(0,a.kt)("p",null,"Output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'{\n  "testRunWebUrl": "http://localhost:11633/test/4oI08rA4g/run/13/test",\n  "results": {\n    "results": [\n      {\n        "results": [\n          {\n            "allPassed": true,\n            "assertion": "attr:tracetest.response.status = 200",\n            "spanResults": [\n              {\n                "observedValue": "200",\n                "passed": true,\n                "spanId": "92e4781f4961bbe9"\n              }\n            ]\n          }\n        ],\n        "selector": {\n          "query": "span[tracetest.span.type=\\"general\\" name=\\"Tracetest trigger\\"]",\n          "structure": [\n            {\n              "filters": [\n                {\n                  "operator": "=",\n                  "property": "tracetest.span.type",\n                  "value": "general"\n                },\n                {\n                  "operator": "=",\n                  "property": "name",\n                  "value": "Tracetest trigger"\n                }\n              ]\n            }\n          ]\n        }\n      },\n      {\n        "results": [\n          {\n            "assertion": "attr:http.response.body| json_path \'$.name\' = \\"diglett\\"",\n            "spanResults": [\n              {\n                "error": "no match"\n              }\n            ]\n          }\n        ],\n        "selector": {\n          "query": "span[tracetest.span.type=\\"http\\" name=\\"HTTP GET pokeapi.pokemon\\" http.method=\\"GET\\"]",\n          "structure": [\n            {\n              "filters": [\n                {\n                  "operator": "=",\n                  "property": "tracetest.span.type",\n                  "value": "http"\n                },\n                {\n                  "operator": "=",\n                  "property": "name",\n                  "value": "HTTP GET pokeapi.pokemon"\n                },\n                {\n                  "operator": "=",\n                  "property": "http.method",\n                  "value": "GET"\n                }\n              ]\n            }\n          ]\n        }\n      },\n      {\n        "results": [\n          {\n            "assertion": "attr:tracetest.span.duration \\u003c 20ms",\n            "spanResults": [\n              {\n                "error": "no match",\n                "observedValue": "22ms",\n                "spanId": "1755c8fc14905bd1"\n              },\n              {\n                "observedValue": "574us",\n                "passed": true,\n                "spanId": "c41f9b8f49f6eb32"\n              },\n              {\n                "observedValue": "1ms",\n                "passed": true,\n                "spanId": "48bef78ad4b3c3ab"\n              }\n            ]\n          }\n        ],\n        "selector": {\n          "query": "span[tracetest.span.type=\\"database\\" db.system=\\"postgresql\\"]",\n          "structure": [\n            {\n              "filters": [\n                {\n                  "operator": "=",\n                  "property": "tracetest.span.type",\n                  "value": "database"\n                },\n                {\n                  "operator": "=",\n                  "property": "db.system",\n                  "value": "postgresql"\n                }\n              ]\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\n')),(0,a.kt)("p",null,"You can also opt to output the result as JUnit to a file. You would run the command with a -j option and a file name, ie:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tracetest test run -d path/to/test.yaml -w -j junit.out\n")),(0,a.kt)("p",null,"The JUnit output file would then contain the JUnit result, for example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'<testsuites name="Pokeshop - Import" tests="5" failures="1" errors="0" skipped="0" time="10">\n        <testsuite name="span[tracetest.span.type=&#34;general&#34; name=&#34;Tracetest trigger&#34;]" tests="1" failures="0" errors="0" skipped="0">\n                <testcase name="attr:tracetest.response.status = 200"></testcase>\n        </testsuite>\n        <testsuite name="span[tracetest.span.type=&#34;http&#34; name=&#34;HTTP GET pokeapi.pokemon&#34; http.method=&#34;GET&#34;]" tests="1" failures="0" errors="0" skipped="0">\n                <testcase name="attr:http.response.body| json_path &#39;$.name&#39; = &#34;diglett&#34;"></testcase>\n        </testsuite>\n        <testsuite name="span[tracetest.span.type=&#34;database&#34; db.system=&#34;postgresql&#34;]" tests="3" failures="1" errors="0" skipped="0">\n                <testcase name="attr:tracetest.span.duration &lt; 20ms">\n                        <failure type="attr:tracetest.span.duration &lt; 20ms" message="21ms"></failure>\n                </testcase>\n                <testcase name="attr:tracetest.span.duration &lt; 20ms"></testcase>\n                <testcase name="attr:tracetest.span.duration &lt; 20ms"></testcase>\n        </testsuite>\n</testsuites>\n')),(0,a.kt)("h2",{id:"running-a-test-that-uses-environment-variables"},"Running a Test That Uses Environment Variables"),(0,a.kt)("p",null,"There are two ways of referencing an environment when running a test. "),(0,a.kt)("p",null,"You can reference an existing environment using its id. For example, given this defined environment with an id of 'testenv':"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"testenv",src:n(81754).Z,width:"1736",height:"620"})),(0,a.kt)("p",null,"We can run a test and specify that environment with this command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tracetest test run -d path/to/test.yaml -e testenv -w\n")),(0,a.kt)("p",null,"You can also reference an environment resource file which will be used to create a new environment or update an existing one. For example, if you have a file named local.env with this content:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"type: Environment\nspec:\n  id: local.env\n  name: local.env\n  values:\n  - key: POKEID\n    value: 45\n  - key: POKENAME\n    value: vileplume\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tracetest test run -d path/to/test.yaml -e path/to/local.env -w\n")),(0,a.kt)("p",null,"If you use the environment resource approach, a new environment will be created in Tracetest."),(0,a.kt)("p",null,"The second approach is very useful if you are running tests from a CI pipeline."))}m.isMDXComponent=!0},81754:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/show-environment-definition-69ba7aef6b87d684e9e8c311e5197aa0.png"}}]);